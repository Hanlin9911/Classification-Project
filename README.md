# Telco Customer Churn Prediction
This project aims to analyze and predict customer churn for a fictional telecommunications company in California. 
The dataset contains various demographic and service-related information of 7043 customers.Check [telco customer churn](https://community.ibm.com/community/user/businessanalytics/blogs/steven-macko/2019/07/11/telco-customer-churn-1113) for more detailed information about the information collected in the dataset. 
The target variable is `Churn Value`

## Exploratory Data Analysis (EDA)
The 33 columns can be divided into 8 categories: 
1. Customer Identification - `CustomerID`, `Count` -> These columns were not further explored as they do not have any power in terms of target.
2. Location - `Zip Code`, `Country`, `State`, `City`, `Lat Long`, `Latitude`, `Longitude` -> Only `Zip Code` was explored as it is mentioned in the data source page. The rest contains overlapping information
3. Customer Labels - `Gender`, `Senior Citizen`, `Partner`, `Dependents`, `Churn Score`, `CLTV`, `Tenure Months` -> `Gender` was not further explored.
4. Services - `Phone Service`, `Multiple Lines`, `Internet Service`, `Online Security`,`Online Backup`, `Device Protection`, `Tech Support`, `Streaming TV`, `Streaming Movies`
5. Payments - `Paperless Billing`, `Payment Method` -> These were not explored as customers can change their payment method and billing relatively easy by themselves.
6. Price Related - `Contract`, `Monthly Charges`, `Total Charges` -> Further explored
7. Target - `Churn Label`, `Churn Value` -> Contains same information, `Churn Value` was used as target.
8. `Churn Reason` - Not further explored as it only exists after a customer churns.

**Major Findings**  
0. Under `Total Charges`, there are unknown ` `, which cannot be converted to numeric values. The blanks were replaced by 0 as all customers with a blank under this columns also has a `Tenure Months` of 0, which is indicating their first bill was not ready leading to 0s in `Total Charges`. 
1. Among numeric features, `Churn Score` has the highest correlation with `Churn Value`. `Tenure Months`, `Total Charges` and `Monthly Charges` are also good predictors of `Churn Value.`
2. `Total Charges` has a strong positive linear relationship with `Tenure Months` * `Monthly Charges` -> Among those three variables, a maximum of 2 can kept in the model to avoid multicollinearity issue. For this reason, `Total Charges` was chosen to be left out.
3. Although in the data resource page, it was stated that `Zip Code` has a strong correlation with `Churn Value`, this was not seen in the EDA.
4. Among the categorical features, only `Partener` is not strongly correlated to `Churn Value`.
5. All the sevices columns were not included in this part but would be further explored in Model 3.

## Functions used in modeling
There are three major functions that are used in modeling. 
1. `param_tuning`
   This function uses `ColumnTransformer`, `Pipeline` and `GridSearchCV` to preprocess and tune the model of choice. The best hyperparamter is chosen based on accuracy or recall. When accuracy > 0.8, recall is optimized, and when this condition is not met, accuracy is optimized.
   Recall is prioritized because a false negative prediction may lead to a customer loss which is considered to be a worse senario than a prediction of false positive. 
2. `testing`
    This function aims to train and test for a given tuned model. It returns a prediction of test values. 
3. `evaluating`
   This function displays a confusion matrix and prints a classification report with given predicted data and actual data.

Supported Vector Classification, K-Nearest Neighbors, Logistic Regression and Random Forest were used in the model creation in following

## Baseline Model with Churn Score.
Since `Churn Score` is the most correlated with `Churn Value`. It was used to build a baseline model as a reference for the future models. 
SVC, LogisticRegression and KNN all showed similar results with an accuracy rate of 0.82, 0.83 and 0.87 respectively. Please note that since the accuracy is all above 0.80, recall was prioritized when choosing the hyperparmeters. 
However, since `Churn Score` was generated by some other unknown algorithm, it was not included as features in the future models as it may poccess some unknown risk (i.e overfitting issues with this dataset).

## Model 2 - Tenure Months, Senior Citizen, Dependents, Contract, Monthly Charges and CLTV
The above features which are all customer labels were used to estbalish Model 2. SVC, LogisticRegression and KNN all showed similar result (0.79, 0.79, and 0.81). The decrease of accuracy was expected as `Churn Score` was not included. 

## Model 3 - Including Services
Although Model 2 performed relatively good, there is potential to increase its performance by adding features of services, as it is also a very important parameter. 
There are 9 services offered by the company including 2 main services, `Internet Service` and `Phone Service` and 7 add-on services (1 under phone and 6 under internet).  The two main services, `Phone Service` and `Internet Service` were included in Model 3. 
Since the execution time for SVC was too long, only LogisticRegression, KNN and RandomForestClassifier were tested. There was a marginal increase in the performance of LogisticRegression but a marginal decrease in the performance of KNN. Overall, the two models shared a similar performance metrics. 

## Model 4 - Average Price
`Average Service Price` was made by summing all services columns to get the number of services each customers use and having the `Monthly Charges` divided. In Model 4, due to the inclusion of `Average Service Price`, `Phone Service` and `Internet Service` were not included in the model.  
The performance were still relatively the same, but since LogisticRegression is the easiest to interpret, it was selected as the final model. 

## Final Model
`service_transformer` and `yes_no_transformer` was created to transform the service columns. The final model was able to produce both positive and negative results.  
It can be seen in the final coefficient table that `Tenure Months`, `Monthly Charges`, `Contract` and `CLTV` dominate the prediction. However, it was not expected that `Tenure Months` has a positive coefficient. Maybe it is due to multicollinearity issue with `CLTV`. This needs to be further explored. 

## Discussion
### Adding `Churn Score`
By including `Churn Score` in the model, the accuracy rate was increased to 0.90. In this case if `CLTV` and `Average Service Price` were removed, it would not change the performance.  
Since `Average Service Price` is the only parameter related to services in the model, it would be kept no matter how little impact it has. Otherwise, it would suggest that the decision of churning is unrelated to the service of the company provides...

### CLTV
Since `CLTV` is a measure of Customer Life Values, it may be used as a evaluation score. For all the false negatives, a sum of CLTV can be found, and the model can be tuned to ensure the accuracy while minimizing the loss. 


